<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Star Neon Upgrader</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root { --gold: #ffaa00; --blue: #00f2ff; --bg: #0f111a; --card: #161b22; }
        body { background: var(--bg); color: white; font-family: 'Segoe UI', sans-serif; display: flex; flex-direction: column; align-items: center; padding: 20px; margin: 0; overflow-x: hidden; }
        
        /* –ó–æ–ª–æ—Ç–æ–π –±–∞–ª–∞–Ω—Å */
        .balance-box { 
            background: var(--card); padding: 15px; border-radius: 15px; border: 2px solid var(--gold); 
            box-shadow: 0 0 15px rgba(255, 170, 0, 0.4); width: 100%; text-align: center; 
            font-size: 1.4rem; font-weight: bold; color: var(--gold); margin-bottom: 20px; box-sizing: border-box;
        }

        /* –°–∏–Ω–∏–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å */
        .mode-switch { 
            display: flex; background: #000; border-radius: 25px; padding: 5px; border: 2px solid var(--blue);
            box-shadow: 0 0 15px rgba(0, 242, 255, 0.3); margin-bottom: 25px;
        }
        .mode-btn { padding: 10px 25px; border-radius: 20px; border: none; color: white; background: transparent; cursor: pointer; transition: 0.3s; font-weight: bold; }
        .mode-btn.active { background: var(--blue); color: black; box-shadow: 0 0 10px var(--blue); }

        /* –ö–æ–ª–µ—Å–æ */
        .wheel-container { position: relative; width: 280px; height: 280px; margin-bottom: 30px; }
        .wheel { 
            width: 100%; height: 100%; border-radius: 50%; border: 5px solid var(--blue); 
            box-shadow: 0 0 25px rgba(0, 242, 255, 0.5);
            background: conic-gradient(#00ff88 0% 40%, #ff3333 40% 100%); 
            transition: transform 4s cubic-bezier(0.1, 0, 0.1, 1); 
        }
        .pointer { 
            position: absolute; top: -15px; left: 50%; transform: translateX(-50%); width: 0; height: 0; 
            border-left: 15px solid transparent; border-right: 15px solid transparent; border-top: 25px solid var(--gold); 
            filter: drop-shadow(0 0 5px var(--gold)); z-index: 10; 
        }

        /* –ë–ª–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è */
        .controls { width: 100%; background: var(--card); padding: 20px; border-radius: 25px; border: 1px solid #333; box-sizing: border-box; }
        input { 
            width: 100%; background: #000; border: 1px solid var(--blue); color: white; 
            padding: 15px; border-radius: 12px; text-align: center; font-size: 1.2rem; margin-bottom: 15px; box-sizing: border-box;
        }
        .mult-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px; }
        .m-btn { background: #1a1f29; border: 1px solid #444; color: white; padding: 12px 0; border-radius: 10px; cursor: pointer; }
        .m-btn.active { border-color: var(--gold); color: var(--gold); box-shadow: 0 0 10px rgba(255, 170, 0, 0.3); }

        .main-btn { 
            width: 100%; background: var(--gold); color: black; border: none; padding: 18px; 
            border-radius: 15px; font-weight: bold; font-size: 1.2rem; box-shadow: 0 0 20px rgba(255, 170, 0, 0.5);
            cursor: pointer; margin-bottom: 15px;
        }
        .withdraw-btn { 
            width: 100%; background: transparent; color: var(--blue); border: 1px solid var(--blue); 
            padding: 12px; border-radius: 15px; cursor: pointer;
        }

        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤—ã–≤–æ–¥–∞ */
        #withdrawModal {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.9); z-index: 100; flex-direction: column; align-items: center; justify-content: center; padding: 20px; box-sizing: border-box;
        }
        .modal-content { background: var(--card); padding: 30px; border-radius: 25px; border: 2px solid var(--blue); width: 100%; max-width: 400px; text-align: center; }
    </style>
</head>
<body>

    <div class="balance-box">
        üí∞ <span id="balanceDisplay">1000.00</span> ‚≠êÔ∏è
    </div>

    <div class="mode-switch">
        <button id="btnDemo" class="mode-btn active" onclick="setMode('demo')">DEMO</button>
        <button id="btnReal" class="mode-btn" onclick="setMode('real')">REAL</button>
    </div>

    <div class="wheel-container">
        <div class="pointer"></div>
        <div id="wheel" class="wheel"></div>
    </div>

    <div class="controls">
        <input type="number" id="betInput" value="20" placeholder="–°—É–º–º–∞ —Å—Ç–∞–≤–∫–∏">
        <div class="mult-grid">
            <button class="m-btn" onclick="setMult(1.2, 70, this)">x1.2</button>
            <button class="m-btn active" onclick="setMult(2.0, 40, this)">x2.0</button>
            <button class="m-btn" onclick="setMult(5.0, 15, this)">x5.0</button>
            <button class="m-btn" onclick="setMult(10.0, 5, this)">x10.0</button>
        </div>
        <button class="main-btn" onclick="play()">–ê–ü–ì–†–ï–ô–î</button>
        <button class="withdraw-btn" onclick="openWithdraw()">–í–´–í–û–î –°–†–ï–î–°–¢–í</button>
    </div>

    <div id="withdrawModal">
        <div class="modal-content">
            <h2 style="color: var(--blue)">–í–´–í–û–î –ó–í–ï–ó–î</h2>
            <input type="number" id="wAmount" placeholder="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–≤–µ–∑–¥">
            <input type="text" id="wWallet" placeholder="–ê–¥—Ä–µ—Å –∫–æ—à–µ–ª—å–∫–∞ / ID">
            <button class="main-btn" onclick="confirmWithdraw()">–û–¢–ü–†–ê–í–ò–¢–¨ –ó–ê–Ø–í–ö–£</button>
            <button class="withdraw-btn" style="border:none" onclick="closeWithdraw()">–û–¢–ú–ï–ù–ê</button>
        </div>
    </div>

    <script>
        let tg = window.Telegram.WebApp;
        tg.expand();

        let mode = 'demo';
        let demoBalance = 1000;
        let realBalance = 0; // –°—é–¥–∞ –±–æ—Ç –±—É–¥–µ—Ç –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –∑–≤–µ–∑–¥—ã
        let rotation = 0;
        let currentMult = 2.0;
        let greenZone = 40;
        let isSpinning = false;

        function setMode(m) {
            if (isSpinning) return;
            mode = m;
            document.getElementById('btnDemo').classList.toggle('active', m === 'demo');
            document.getElementById('btnReal').classList.toggle('active', m === 'real');
            updateBalance();
        }

        function setMult(val, zone, btn) {
            if (isSpinning) return;
            currentMult = val;
            greenZone = zone;
            document.querySelectorAll('.m-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            document.getElementById('wheel').style.background = `conic-gradient(#00ff88 0% ${greenZone}%, #ff3333 ${greenZone}% 100%)`;
        }

        function updateBalance() {
            document.getElementById('balanceDisplay').innerText = (mode === 'demo' ? demoBalance : realBalance).toFixed(2);
        }

        function play() {
            if (isSpinning) return;
            let bet = parseFloat(document.getElementById('betInput').value);
            if (isNaN(bet) || bet < 20) return alert("–ú–∏–Ω–∏–º—É–º 20 –∑–≤–µ–∑–¥!");

            if (mode === 'demo') {
                if (demoBalance < bet) return alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–µ–º–æ-–∑–≤–µ–∑–¥!");
                isSpinning = true;
                demoBalance -= bet;
                updateBalance();

                let win = Math.random() < 0.8; 
                spin(win);

                setTimeout(() => {
                    if (win) {
                        demoBalance += bet * currentMult;
                        alert("–í–´–ò–ì–†–´–®! +" + (bet * currentMult).toFixed(2));
                    } else {
                        alert("–ü–†–û–ò–ì–†–´–®");
                    }
                    updateBalance();
                    isSpinning = false;
                }, 4100);
            } else {
                // –í —Ä–µ–∞–ª—å–Ω–æ–º —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å—Ç–æ —à–ª–µ–º –∑–∞–ø—Ä–æ—Å –±–æ—Ç—É
                tg.sendData(JSON.stringify({action: "spin_real", bet: bet}));
                tg.close();
            }
        }

        function spin(win) {
            const wheel = document.getElementById('wheel');
            let stopAngle;
            // –£–≥–æ–ª 0 - —ç—Ç–æ –≥—Ä–∞–Ω–∏—Ü–∞ –º–µ–∂–¥—É –∑–µ–ª–µ–Ω—ã–º –∏ –∫—Ä–∞—Å–Ω—ã–º (–≤–µ—Ä—Ö–Ω—è—è —Ç–æ—á–∫–∞)
            if (win) {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –≤ –∑–µ–ª–µ–Ω–æ–π –∑–æ–Ω–µ (—Å–ø—Ä–∞–≤–∞ –æ—Ç 0)
                stopAngle = Math.random() * (greenZone * 3.6 - 10) + 5;
            } else {
                // –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º—Å—è –≤ –∫—Ä–∞—Å–Ω–æ–π –∑–æ–Ω–µ (—Å–ª–µ–≤–∞ –æ—Ç 0)
                let redStart = (greenZone * 3.6) + 15;
                stopAngle = redStart + Math.random() * (340 - redStart);
            }
            rotation += (360 * 5) - stopAngle; 
            wheel.style.transform = `rotate(${rotation}deg)`;
        }

        // –õ–æ–≥–∏–∫–∞ –≤—ã–≤–æ–¥–∞
        function openWithdraw() { document.getElementById('withdrawModal').style.display = 'flex'; }
        function closeWithdraw() { document.getElementById('withdrawModal').style.display = 'none'; }
        
        function confirmWithdraw() {
            let amount = document.getElementById('wAmount').value;
            if (amount < 100) return alert("–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ ‚Äî 100 –∑–≤–µ–∑–¥!");
            tg.sendData(JSON.stringify({action: "withdraw", amount: amount}));
            alert("–ó–∞—è–≤–∫–∞ –ø—Ä–∏–Ω—è—Ç–∞! –°—Ä–µ–¥—Å—Ç–≤–∞ –±—É–¥—É—Ç –∑–∞—á–∏—Å–ª–µ–Ω—ã –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤.");
            closeWithdraw();
        }
    </script>
</body>
</html>
